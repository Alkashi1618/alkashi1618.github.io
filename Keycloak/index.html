<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab Keycloak - Syst√®me d'Authentification Centralis√©e</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header .subtitle {
            color: #666;
            font-size: 1.2em;
            margin-bottom: 20px;
        }

        .meta-info {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .meta-badge {
            background: #f0f0f0;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            color: #555;
            font-weight: 600;
        }

        .meta-badge.type {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .content-section {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        h3 {
            color: #764ba2;
            font-size: 1.5em;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        h4 {
            color: #555;
            font-size: 1.2em;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        p {
            margin-bottom: 15px;
            text-align: justify;
        }

        ul, ol {
            margin-left: 30px;
            margin-bottom: 20px;
        }

        li {
            margin-bottom: 10px;
        }

        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .highlight {
            background: #fff3cd;
            padding: 20px;
            border-left: 4px solid #ffc107;
            border-radius: 5px;
            margin: 20px 0;
        }

        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .success-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .steps {
            counter-reset: step-counter;
            list-style: none;
            margin-left: 0;
        }

        .steps li {
            counter-increment: step-counter;
            padding-left: 50px;
            position: relative;
            margin-bottom: 25px;
        }

        .steps li::before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .tech-stack {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }

        .tech-tag {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
        }

        .back-button {
            display: inline-block;
            background: white;
            color: #667eea;
            padding: 12px 30px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .back-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        footer {
            text-align: center;
            color: white;
            padding: 30px;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }

            .content-section {
                padding: 25px;
            }

            .meta-info {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-button">‚Üê Retour au portfolio</a>

        <header>
            <h1>üîê Mise en place d'un syst√®me d'authentification centralis√©e avec Keycloak</h1>
            <p class="subtitle">Single Sign-On (SSO) avec OAuth2 et OpenID Connect</p>
            
            <div class="meta-info">
                <span class="meta-badge type">LAB</span>
                <span class="meta-badge">üè¢ S√©curit√© & Authentification</span>
                <span class="meta-badge">‚è±Ô∏è Dur√©e: 4-6 heures</span>
            </div>

            <div class="tech-stack">
                <span class="tech-tag">Keycloak</span>
                <span class="tech-tag">Docker</span>
                <span class="tech-tag">OAuth2</span>
                <span class="tech-tag">OpenID Connect</span>
                <span class="tech-tag">JWT</span>
                <span class="tech-tag">Node.js</span>
            </div>
        </header>

        <div class="content-section">
            <h2>üìã Introduction</h2>
            <p>
                Dans le cadre de la s√©curisation et de la centralisation de l'acc√®s aux diff√©rentes applications internes, 
                l'entreprise souhaite mettre en place une solution d'authentification unifi√©e bas√©e sur Keycloak. 
                Ce TP vise √† comprendre le fonctionnement d'un syst√®me SSO (Single Sign-On) avec OAuth2 et OpenID Connect.
            </p>
        </div>

        <div class="content-section">
            <h2>üéØ Objectif</h2>
            <p>
                Mettre en place un syst√®me d'authentification centralis√© permettant aux diff√©rentes applications web de l'entreprise 
                de d√©l√©guer l'authentification √† un serveur Keycloak. L'objectif est de comprendre les r√¥les OAuth2, les flux de 
                connexion s√©curis√©s (Authorization Code + PKCE) et la gestion des utilisateurs, r√¥les et clients.
            </p>
        </div>

        <div class="content-section">
            <h2>üöÄ Partie 1 ‚Äì Installation de Keycloak</h2>
            
            <div class="info-box">
                <strong>üì¶ Installation via Docker</strong>
                <p>Keycloak peut √™tre rapidement d√©ploy√© en utilisant Docker pour un environnement de d√©veloppement.</p>
            </div>

            <div class="code-block">docker run -p 8080:8080 -e KEYCLOAK_ADMIN=admin -e KEYCLOAK_ADMIN_PASSWORD=admin \
  quay.io/keycloak/keycloak:24.0.3 start-dev</div>

            <p>Une fois lanc√©, Keycloak est accessible √† l'adresse : <strong>http://localhost:8080</strong></p>
        </div>

        <div class="content-section">
            <h2>‚öôÔ∏è Partie 2 ‚Äì Configuration de Keycloak</h2>
            
            <ol class="steps">
                <li>
                    <strong>Cr√©ation du Realm 'tdsi'</strong>
                    <p>Un realm est un espace isol√© pour g√©rer utilisateurs, r√¥les et applications. Chaque realm repr√©sente un p√©rim√®tre de s√©curit√© distinct.</p>
                </li>
                <li>
                    <strong>Cr√©ation des utilisateurs Alice et Bob</strong>
                    <p>Ajout de comptes utilisateurs avec d√©finition des mots de passe et configuration des actions requises (OTP, WebAuthn, v√©rification email, etc.).</p>
                </li>
                <li>
                    <strong>Attribution des r√¥les 'user' et 'admin'</strong>
                    <p>Affectation des r√¥les aux utilisateurs pour g√©rer les acc√®s aux diff√©rentes ressources et fonctionnalit√©s.</p>
                </li>
            </ol>
        </div>

        <div class="content-section">
            <h2>üîå Partie 3 ‚Äì Cr√©ation et configuration des clients</h2>
            
            <p>Deux types de clients sont cr√©√©s pour illustrer diff√©rents cas d'usage :</p>

            <h3>1. Client Backend (Confidential)</h3>
            <div class="highlight">
                <strong>backend-api</strong>
                <ul>
                    <li>Type : Confidential</li>
                    <li>Service Accounts Enabled : ON</li>
                    <li>Peut stocker un client_secret de mani√®re s√©curis√©e</li>
                    <li>Id√©al pour les APIs et serveurs backend</li>
                </ul>
            </div>

            <h3>2. Client Mobile (Public)</h3>
            <div class="highlight">
                <strong>mobile-app</strong>
                <ul>
                    <li>Type : Public</li>
                    <li>Standard Flow + PKCE activ√©</li>
                    <li>Ne peut pas garder de secret c√¥t√© client</li>
                    <li>Adapt√© pour les applications mobiles et SPA</li>
                </ul>
            </div>
        </div>

        <div class="content-section">
            <h2>üß™ Partie 4 ‚Äì Test de l'authentification</h2>
            
            <ol class="steps">
                <li>
                    <strong>Lancer l'API Node.js s√©curis√©e par Keycloak</strong>
                    <p>Configuration d'une API backend prot√©g√©e qui valide les tokens JWT √©mis par Keycloak.</p>
                </li>
                <li>
                    <strong>Tester avec Postman (Authorization Code + PKCE)</strong>
                    <p>Simulation du flux d'authentification OAuth2 avec PKCE pour s√©curiser les √©changes.</p>
                </li>
                <li>
                    <strong>Appeler l'API prot√©g√©e</strong>
                    <p>Utilisation du token d'acc√®s pour effectuer des requ√™tes vers les endpoints s√©curis√©s.</p>
                </li>
            </ol>
        </div>

        <div class="content-section">
            <h2>üîç Partie 5 ‚Äì Analyse et compr√©hension</h2>

            <h3>1. Diff√©rence entre OAuth2 et OpenID Connect</h3>
            <div class="info-box">
                <p><strong>OAuth2</strong> est un protocole d'<em>autorisation</em> permettant √† une application d'acc√©der √† des ressources 
                sans transmettre le mot de passe utilisateur, via un <strong>access token</strong> (jeton d'acc√®s).</p>
                
                <p><strong>OpenID Connect (OIDC)</strong> ajoute une couche d'<em>authentification</em> sur OAuth2. Il √©met un 
                <strong>id_token</strong> (souvent un JWT) contenant des informations sur l'identit√© de l'utilisateur, permettant 
                √† l'application de s'assurer de qui est connect√©, en plus de contr√¥ler les acc√®s.</p>
            </div>

            <h3>2. Que contient un JWT</h3>
            <p>Un JWT (JSON Web Token) est form√© de trois parties :</p>
            <ul>
                <li><strong>Header :</strong> Sp√©cifie l'algorithme de signature et le type du jeton.</li>
                <li><strong>Payload :</strong> Contient les claims, c'est-√†-dire les donn√©es sur l'utilisateur, ses autorisations, ses r√¥les, etc.</li>
                <li><strong>Signature :</strong> Permet de valider l'int√©grit√© du jeton (qu'il n'a pas √©t√© modifi√©).</li>
            </ul>

            <h3>3. Comment Keycloak v√©rifie les permissions</h3>
            <p>
                Keycloak attribue √† chaque utilisateur authentifi√© un JWT (access_token) contenant ses r√¥les et permissions, 
                correspondant √† ce qui est d√©fini dans le realm et au niveau des clients.
            </p>
            <p>
                Les applications ou APIs consultent ce token pour d√©terminer si l'utilisateur poss√®de les droits suffisants 
                pour acc√©der √† une ressource ou fonctionnalit√© pr√©cise, en se basant sur les r√¥les et claims du token. 
                La v√©rification se fait donc via d√©codage et inspection du contenu du JWT, qui sert de preuve d'identit√© et d'autorisation.
            </p>
        </div>

        <div class="content-section">
            <h2>üìö R√©sum√© : Keycloak en d√©tail</h2>

            <h3>1Ô∏è‚É£ Keycloak ‚Äì C'est quoi ?</h3>
            <p>
                Keycloak est une solution <strong>open-source</strong> de gestion des identit√©s et des acc√®s 
                (Identity and Access Management ‚Äì IAM). Il permet de centraliser l'authentification et l'autorisation 
                des utilisateurs pour diverses applications web, API ou mobiles, et offre un syst√®me de <strong>Single Sign-On (SSO)</strong>.
            </p>

            <h4>Fonctionnalit√©s principales :</h4>
            <ul>
                <li><strong>Authentification centralis√©e :</strong> les utilisateurs se connectent une seule fois pour acc√©der √† plusieurs applications</li>
                <li><strong>Gestion des utilisateurs :</strong> cr√©ation, modification, suppression d'utilisateurs, gestion des r√¥les et groupes</li>
                <li><strong>Protocoles standards support√©s :</strong> OAuth2, OpenID Connect (OIDC), SAML 2.0</li>
                <li><strong>Gestion des r√¥les et permissions :</strong> contr√¥le fin d'acc√®s aux ressources</li>
                <li><strong>S√©curit√© renforc√©e :</strong> support de 2FA, WebAuthn (biom√©trie), OTP, etc.</li>
                <li><strong>Identit√© f√©d√©r√©e :</strong> connexion via Google, Facebook, AzureAD, ou d'autres serveurs Keycloak</li>
                <li><strong>Jetons et tokens :</strong> utilisation de JWT pour s√©curiser les √©changes entre clients et serveurs</li>
            </ul>

            <h3>3Ô∏è‚É£ Pourquoi l'utiliser ?</h3>
            <div class="success-box">
                <ul>
                    <li>‚úÖ <strong>Centralisation de l'authentification :</strong> √âvite de cr√©er un syst√®me d'authentification diff√©rent pour chaque application</li>
                    <li>üîí <strong>S√©curit√© renforc√©e :</strong> Mot de passe jamais partag√© avec les applications clientes, support de 2FA, WebAuthn, OTP</li>
                    <li>üéØ <strong>Contr√¥le fin des permissions :</strong> R√¥les et groupes permettent de restreindre l'acc√®s √† certaines ressources</li>
                    <li>üîó <strong>Interop√©rabilit√© :</strong> Supporte OAuth2, OIDC et SAML, facilitant l'int√©gration avec d'autres syst√®mes</li>
                    <li>üòä <strong>Exp√©rience utilisateur am√©lior√©e :</strong> SSO - l'utilisateur se connecte une seule fois pour acc√©der √† toutes les applications</li>
                    <li>üìà <strong>Scalabilit√© :</strong> Id√©al pour les entreprises avec plusieurs applications internes ou microservices</li>
                </ul>
            </div>

            <h3>4Ô∏è‚É£ O√π l'utiliser ?</h3>
            <ul>
                <li>Entreprises ayant plusieurs applications internes ou externes</li>
                <li>Projets n√©cessitant authentification unique (SSO) pour am√©liorer la s√©curit√© et l'exp√©rience utilisateur</li>
                <li>Applications mobiles ou web avec API s√©curis√©es</li>
                <li>Sc√©narios o√π des tiers doivent acc√©der √† des ressources sans partager leurs identifiants</li>
                <li>Organisations n√©cessitant r√¥les, permissions et audit centralis√©s</li>
            </ul>
        </div>

        <div class="content-section">
            <h2>üèóÔ∏è Comment utiliser Keycloak dans votre infrastructure ?</h2>
            
            <ol class="steps">
                <li>
                    <strong>D√©ploiement de Keycloak</strong>
                    <p>Installer Keycloak sur un serveur ou via un conteneur Docker, pour disposer d'une instance accessible par votre infrastructure.</p>
                </li>
                <li>
                    <strong>Cr√©ation d'un Realm</strong>
                    <p>Configurer un realm, espace isol√© pour g√©rer les utilisateurs, r√¥les et applications. Chaque realm repr√©sente un p√©rim√®tre de s√©curit√© distinct.</p>
                </li>
                <li>
                    <strong>D√©finition des utilisateurs et r√¥les</strong>
                    <p>Cr√©er les comptes utilisateurs, d√©finir leurs r√¥les et permissions, et configurer les actions requises.</p>
                </li>
                <li>
                    <strong>Enregistrement des applications en tant que clients</strong>
                    <p>Chaque application (web, mobile, API) est enregistr√©e dans Keycloak comme un client (public ou confidentiel).</p>
                </li>
                <li>
                    <strong>Configuration des protocoles d'authentification</strong>
                    <p>Utiliser les flows OAuth2 et OpenID Connect adapt√©s pour permettre aux applications d'obtenir des jetons.</p>
                </li>
                <li>
                    <strong>Int√©gration dans les applications</strong>
                    <p>Les applications utilisent les biblioth√®ques clientes Keycloak pour rediriger l'utilisateur, recevoir les tokens JWT, et valider l'identit√©.</p>
                </li>
                <li>
                    <strong>Validation c√¥t√© serveur</strong>
                    <p>Les APIs et serveurs valident les tokens JWT re√ßus, v√©rifient la signature et les r√¥les d'acc√®s avant d'autoriser les requ√™tes.</p>
                </li>
            </ol>
        </div>

        <div class="content-section">
            <h2>‚úÖ Conclusion</h2>
            <div class="success-box">
                <p>
                    Ce mini LAB nous a permis de comprendre la mise en place d'un serveur d'identit√© Keycloak et l'int√©gration 
                    d'un syst√®me d'authentification centralis√© bas√© sur les standards <strong>OAuth2</strong> et <strong>OpenID Connect</strong>. 
                    La configuration des r√¥les, utilisateurs, clients et des flux PKCE permet d'assurer un haut niveau de s√©curit√© 
                    tout en simplifiant la gestion des acc√®s.
                </p>
                <p>
                    Cette approche montre comment Keycloak agit comme un serveur d'identit√© et d'autorisation centralis√©, 
                    interfac√© avec des applications via des protocoles standards, simplifiant la s√©curit√© et l'administration 
                    de votre syst√®me informatique.
                </p>
            </div>
        </div>

        <footer>
            <p>¬© 2024 - Portfolio Technique | <a href="../index.html" style="color: white; text-decoration: underline;">Retour au portfolio</a></p>
        </footer>
    </div>
</body>
</html>
